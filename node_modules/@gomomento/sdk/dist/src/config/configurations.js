"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.InRegion = exports.Laptop = void 0;
const configuration_1 = require("./configuration");
const fixed_count_retry_strategy_1 = require("./retry/fixed-count-retry-strategy");
const transport_1 = require("./transport");
const default_momento_logger_1 = require("./logging/default-momento-logger");
// 4 minutes.  We want to remain comfortably underneath the idle timeout for AWS NLB, which is 350s.
const defaultMaxIdleMillis = 4 * 60 * 1000;
const defaultMaxSessionMemoryMb = 256;
const defaultLoggerFactory = new default_momento_logger_1.DefaultMomentoLoggerFactory();
const defaultMiddlewares = [];
function defaultRetryStrategy(loggerFactory) {
    return new fixed_count_retry_strategy_1.FixedCountRetryStrategy({
        loggerFactory: loggerFactory,
        maxAttempts: 3,
    });
}
/**
 * Laptop config provides defaults suitable for a medium-to-high-latency dev environment.  Permissive timeouts, retries, and
 * relaxed latency and throughput targets.
 * @export
 * @class Laptop
 */
class Laptop extends configuration_1.CacheConfiguration {
    /**
     * Provides the latest recommended configuration for a laptop development environment.  NOTE: this configuration may
     * change in future releases to take advantage of improvements we identify for default configurations.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static latest(loggerFactory = defaultLoggerFactory) {
        return Laptop.v1(loggerFactory);
    }
    /**
     * Provides v1 recommended configuration for a laptop development environment.  This configuration is guaranteed not
     * to change in future releases of the Momento node.js SDK.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static v1(loggerFactory = defaultLoggerFactory) {
        const deadlineMillis = 5000;
        const grpcConfig = new transport_1.StaticGrpcConfiguration({
            deadlineMillis: deadlineMillis,
            maxSessionMemoryMb: defaultMaxSessionMemoryMb,
        });
        const transportStrategy = new transport_1.StaticTransportStrategy({
            grpcConfiguration: grpcConfig,
            maxIdleMillis: defaultMaxIdleMillis,
        });
        return new Laptop({
            loggerFactory: loggerFactory,
            retryStrategy: defaultRetryStrategy(loggerFactory),
            transportStrategy: transportStrategy,
            middlewares: defaultMiddlewares,
        });
    }
}
exports.Laptop = Laptop;
class InRegionDefault extends configuration_1.CacheConfiguration {
    /**
     * Provides the latest recommended configuration for a typical in-region environment.  NOTE: this configuration may
     * change in future releases to take advantage of improvements we identify for default configurations.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static latest(loggerFactory = defaultLoggerFactory) {
        return InRegionDefault.v1(loggerFactory);
    }
    /**
     * Provides v1 recommended configuration for a typical in-region environment.  This configuration is guaranteed not
     * to change in future releases of the Momento node.js SDK.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static v1(loggerFactory = defaultLoggerFactory) {
        const deadlineMillis = 1100;
        const grpcConfig = new transport_1.StaticGrpcConfiguration({
            deadlineMillis: deadlineMillis,
            maxSessionMemoryMb: defaultMaxSessionMemoryMb,
        });
        const transportStrategy = new transport_1.StaticTransportStrategy({
            grpcConfiguration: grpcConfig,
            maxIdleMillis: defaultMaxIdleMillis,
        });
        return new InRegionDefault({
            loggerFactory: loggerFactory,
            retryStrategy: defaultRetryStrategy(loggerFactory),
            transportStrategy: transportStrategy,
            middlewares: defaultMiddlewares,
        });
    }
}
class InRegionLowLatency extends configuration_1.CacheConfiguration {
    /**
     * Provides the latest recommended configuration for an in-region environment with aggressive low-latency requirements.
     * NOTE: this configuration may change in future releases to take advantage of improvements we identify for default
     * configurations.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static latest(loggerFactory = defaultLoggerFactory) {
        return InRegionLowLatency.v1(loggerFactory);
    }
    /**
     * Provides v1 recommended configuration for an in-region environment with aggressive low-latency requirements.
     * This configuration is guaranteed not to change in future releases of the Momento node.js SDK.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static v1(loggerFactory = defaultLoggerFactory) {
        const deadlineMillis = 500;
        const grpcConfig = new transport_1.StaticGrpcConfiguration({
            deadlineMillis: deadlineMillis,
            maxSessionMemoryMb: defaultMaxSessionMemoryMb,
        });
        const transportStrategy = new transport_1.StaticTransportStrategy({
            grpcConfiguration: grpcConfig,
            maxIdleMillis: defaultMaxIdleMillis,
        });
        return new InRegionDefault({
            loggerFactory: loggerFactory,
            retryStrategy: defaultRetryStrategy(loggerFactory),
            transportStrategy: transportStrategy,
            middlewares: defaultMiddlewares,
        });
    }
}
/**
 * InRegion provides defaults suitable for an environment where your client is running in the same region as the Momento
 * service.  It has more aggressive timeouts and retry behavior than the Laptop config.
 * @export
 * @class InRegion
 */
class InRegion {
}
exports.InRegion = InRegion;
/**
 * This config prioritizes throughput and client resource utilization.  It has a slightly relaxed client-side timeout
 * setting to maximize throughput.
 * @type {InRegionDefault}
 */
InRegion.Default = InRegionDefault;
/**
 * This config prioritizes keeping p99.9 latencies as low as possible, potentially sacrificing
 * some throughput to achieve this.  It has a very aggressive client-side timeout.  Use this
 * configuration if the most important factor is to ensure that cache unavailability doesn't force
 * unacceptably high latencies for your own application.
 * @type {InRegionLowLatency}
 */
InRegion.LowLatency = InRegionLowLatency;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlndXJhdGlvbnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29uZmlnL2NvbmZpZ3VyYXRpb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLG1EQUFtRDtBQUNuRCxtRkFBMkU7QUFJM0UsMkNBS3FCO0FBQ3JCLDZFQUE2RTtBQUU3RSxvR0FBb0c7QUFDcEcsTUFBTSxvQkFBb0IsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLElBQUssQ0FBQztBQUM1QyxNQUFNLHlCQUF5QixHQUFHLEdBQUcsQ0FBQztBQUN0QyxNQUFNLG9CQUFvQixHQUN4QixJQUFJLG9EQUEyQixFQUFFLENBQUM7QUFDcEMsTUFBTSxrQkFBa0IsR0FBaUIsRUFBRSxDQUFDO0FBRTVDLFNBQVMsb0JBQW9CLENBQzNCLGFBQW1DO0lBRW5DLE9BQU8sSUFBSSxvREFBdUIsQ0FBQztRQUNqQyxhQUFhLEVBQUUsYUFBYTtRQUM1QixXQUFXLEVBQUUsQ0FBQztLQUNmLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFRDs7Ozs7R0FLRztBQUNILE1BQWEsTUFBTyxTQUFRLGtDQUFrQjtJQUM1Qzs7Ozs7T0FLRztJQUNILE1BQU0sQ0FBQyxNQUFNLENBQ1gsZ0JBQXNDLG9CQUFvQjtRQUUxRCxPQUFPLE1BQU0sQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsTUFBTSxDQUFDLEVBQUUsQ0FDUCxnQkFBc0Msb0JBQW9CO1FBRTFELE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQztRQUM1QixNQUFNLFVBQVUsR0FBc0IsSUFBSSxtQ0FBdUIsQ0FBQztZQUNoRSxjQUFjLEVBQUUsY0FBYztZQUM5QixrQkFBa0IsRUFBRSx5QkFBeUI7U0FDOUMsQ0FBQyxDQUFDO1FBQ0gsTUFBTSxpQkFBaUIsR0FBc0IsSUFBSSxtQ0FBdUIsQ0FBQztZQUN2RSxpQkFBaUIsRUFBRSxVQUFVO1lBQzdCLGFBQWEsRUFBRSxvQkFBb0I7U0FDcEMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxJQUFJLE1BQU0sQ0FBQztZQUNoQixhQUFhLEVBQUUsYUFBYTtZQUM1QixhQUFhLEVBQUUsb0JBQW9CLENBQUMsYUFBYSxDQUFDO1lBQ2xELGlCQUFpQixFQUFFLGlCQUFpQjtZQUNwQyxXQUFXLEVBQUUsa0JBQWtCO1NBQ2hDLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRjtBQXRDRCx3QkFzQ0M7QUFFRCxNQUFNLGVBQWdCLFNBQVEsa0NBQWtCO0lBQzlDOzs7OztPQUtHO0lBQ0gsTUFBTSxDQUFDLE1BQU0sQ0FDWCxnQkFBc0Msb0JBQW9CO1FBRTFELE9BQU8sZUFBZSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUMzQyxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxNQUFNLENBQUMsRUFBRSxDQUNQLGdCQUFzQyxvQkFBb0I7UUFFMUQsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDO1FBQzVCLE1BQU0sVUFBVSxHQUFzQixJQUFJLG1DQUF1QixDQUFDO1lBQ2hFLGNBQWMsRUFBRSxjQUFjO1lBQzlCLGtCQUFrQixFQUFFLHlCQUF5QjtTQUM5QyxDQUFDLENBQUM7UUFDSCxNQUFNLGlCQUFpQixHQUFzQixJQUFJLG1DQUF1QixDQUFDO1lBQ3ZFLGlCQUFpQixFQUFFLFVBQVU7WUFDN0IsYUFBYSxFQUFFLG9CQUFvQjtTQUNwQyxDQUFDLENBQUM7UUFDSCxPQUFPLElBQUksZUFBZSxDQUFDO1lBQ3pCLGFBQWEsRUFBRSxhQUFhO1lBQzVCLGFBQWEsRUFBRSxvQkFBb0IsQ0FBQyxhQUFhLENBQUM7WUFDbEQsaUJBQWlCLEVBQUUsaUJBQWlCO1lBQ3BDLFdBQVcsRUFBRSxrQkFBa0I7U0FDaEMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGO0FBRUQsTUFBTSxrQkFBbUIsU0FBUSxrQ0FBa0I7SUFDakQ7Ozs7OztPQU1HO0lBQ0gsTUFBTSxDQUFDLE1BQU0sQ0FDWCxnQkFBc0Msb0JBQW9CO1FBRTFELE9BQU8sa0JBQWtCLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzlDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILE1BQU0sQ0FBQyxFQUFFLENBQ1AsZ0JBQXNDLG9CQUFvQjtRQUUxRCxNQUFNLGNBQWMsR0FBRyxHQUFHLENBQUM7UUFDM0IsTUFBTSxVQUFVLEdBQXNCLElBQUksbUNBQXVCLENBQUM7WUFDaEUsY0FBYyxFQUFFLGNBQWM7WUFDOUIsa0JBQWtCLEVBQUUseUJBQXlCO1NBQzlDLENBQUMsQ0FBQztRQUNILE1BQU0saUJBQWlCLEdBQXNCLElBQUksbUNBQXVCLENBQUM7WUFDdkUsaUJBQWlCLEVBQUUsVUFBVTtZQUM3QixhQUFhLEVBQUUsb0JBQW9CO1NBQ3BDLENBQUMsQ0FBQztRQUNILE9BQU8sSUFBSSxlQUFlLENBQUM7WUFDekIsYUFBYSxFQUFFLGFBQWE7WUFDNUIsYUFBYSxFQUFFLG9CQUFvQixDQUFDLGFBQWEsQ0FBQztZQUNsRCxpQkFBaUIsRUFBRSxpQkFBaUI7WUFDcEMsV0FBVyxFQUFFLGtCQUFrQjtTQUNoQyxDQUFDLENBQUM7SUFDTCxDQUFDO0NBQ0Y7QUFFRDs7Ozs7R0FLRztBQUNILE1BQWEsUUFBUTs7QUFBckIsNEJBZUM7QUFkQzs7OztHQUlHO0FBQ0ksZ0JBQU8sR0FBRyxlQUFlLENBQUM7QUFDakM7Ozs7OztHQU1HO0FBQ0ksbUJBQVUsR0FBRyxrQkFBa0IsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q2FjaGVDb25maWd1cmF0aW9ufSBmcm9tICcuL2NvbmZpZ3VyYXRpb24nO1xuaW1wb3J0IHtGaXhlZENvdW50UmV0cnlTdHJhdGVneX0gZnJvbSAnLi9yZXRyeS9maXhlZC1jb3VudC1yZXRyeS1zdHJhdGVneSc7XG5pbXBvcnQge1JldHJ5U3RyYXRlZ3l9IGZyb20gJy4vcmV0cnkvcmV0cnktc3RyYXRlZ3knO1xuaW1wb3J0IHtNaWRkbGV3YXJlfSBmcm9tICcuL21pZGRsZXdhcmUvbWlkZGxld2FyZSc7XG5pbXBvcnQge01vbWVudG9Mb2dnZXJGYWN0b3J5fSBmcm9tICdAZ29tb21lbnRvL3Nkay1jb3JlJztcbmltcG9ydCB7XG4gIEdycGNDb25maWd1cmF0aW9uLFxuICBTdGF0aWNHcnBjQ29uZmlndXJhdGlvbixcbiAgU3RhdGljVHJhbnNwb3J0U3RyYXRlZ3ksXG4gIFRyYW5zcG9ydFN0cmF0ZWd5LFxufSBmcm9tICcuL3RyYW5zcG9ydCc7XG5pbXBvcnQge0RlZmF1bHRNb21lbnRvTG9nZ2VyRmFjdG9yeX0gZnJvbSAnLi9sb2dnaW5nL2RlZmF1bHQtbW9tZW50by1sb2dnZXInO1xuXG4vLyA0IG1pbnV0ZXMuICBXZSB3YW50IHRvIHJlbWFpbiBjb21mb3J0YWJseSB1bmRlcm5lYXRoIHRoZSBpZGxlIHRpbWVvdXQgZm9yIEFXUyBOTEIsIHdoaWNoIGlzIDM1MHMuXG5jb25zdCBkZWZhdWx0TWF4SWRsZU1pbGxpcyA9IDQgKiA2MCAqIDFfMDAwO1xuY29uc3QgZGVmYXVsdE1heFNlc3Npb25NZW1vcnlNYiA9IDI1NjtcbmNvbnN0IGRlZmF1bHRMb2dnZXJGYWN0b3J5OiBNb21lbnRvTG9nZ2VyRmFjdG9yeSA9XG4gIG5ldyBEZWZhdWx0TW9tZW50b0xvZ2dlckZhY3RvcnkoKTtcbmNvbnN0IGRlZmF1bHRNaWRkbGV3YXJlczogTWlkZGxld2FyZVtdID0gW107XG5cbmZ1bmN0aW9uIGRlZmF1bHRSZXRyeVN0cmF0ZWd5KFxuICBsb2dnZXJGYWN0b3J5OiBNb21lbnRvTG9nZ2VyRmFjdG9yeVxuKTogUmV0cnlTdHJhdGVneSB7XG4gIHJldHVybiBuZXcgRml4ZWRDb3VudFJldHJ5U3RyYXRlZ3koe1xuICAgIGxvZ2dlckZhY3Rvcnk6IGxvZ2dlckZhY3RvcnksXG4gICAgbWF4QXR0ZW1wdHM6IDMsXG4gIH0pO1xufVxuXG4vKipcbiAqIExhcHRvcCBjb25maWcgcHJvdmlkZXMgZGVmYXVsdHMgc3VpdGFibGUgZm9yIGEgbWVkaXVtLXRvLWhpZ2gtbGF0ZW5jeSBkZXYgZW52aXJvbm1lbnQuICBQZXJtaXNzaXZlIHRpbWVvdXRzLCByZXRyaWVzLCBhbmRcbiAqIHJlbGF4ZWQgbGF0ZW5jeSBhbmQgdGhyb3VnaHB1dCB0YXJnZXRzLlxuICogQGV4cG9ydFxuICogQGNsYXNzIExhcHRvcFxuICovXG5leHBvcnQgY2xhc3MgTGFwdG9wIGV4dGVuZHMgQ2FjaGVDb25maWd1cmF0aW9uIHtcbiAgLyoqXG4gICAqIFByb3ZpZGVzIHRoZSBsYXRlc3QgcmVjb21tZW5kZWQgY29uZmlndXJhdGlvbiBmb3IgYSBsYXB0b3AgZGV2ZWxvcG1lbnQgZW52aXJvbm1lbnQuICBOT1RFOiB0aGlzIGNvbmZpZ3VyYXRpb24gbWF5XG4gICAqIGNoYW5nZSBpbiBmdXR1cmUgcmVsZWFzZXMgdG8gdGFrZSBhZHZhbnRhZ2Ugb2YgaW1wcm92ZW1lbnRzIHdlIGlkZW50aWZ5IGZvciBkZWZhdWx0IGNvbmZpZ3VyYXRpb25zLlxuICAgKiBAcGFyYW0ge01vbWVudG9Mb2dnZXJGYWN0b3J5fSBbbG9nZ2VyRmFjdG9yeT1kZWZhdWx0TG9nZ2VyRmFjdG9yeV1cbiAgICogQHJldHVybnMge0NhY2hlQ29uZmlndXJhdGlvbn1cbiAgICovXG4gIHN0YXRpYyBsYXRlc3QoXG4gICAgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3RvcnkgPSBkZWZhdWx0TG9nZ2VyRmFjdG9yeVxuICApOiBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAgIHJldHVybiBMYXB0b3AudjEobG9nZ2VyRmFjdG9yeSk7XG4gIH1cblxuICAvKipcbiAgICogUHJvdmlkZXMgdjEgcmVjb21tZW5kZWQgY29uZmlndXJhdGlvbiBmb3IgYSBsYXB0b3AgZGV2ZWxvcG1lbnQgZW52aXJvbm1lbnQuICBUaGlzIGNvbmZpZ3VyYXRpb24gaXMgZ3VhcmFudGVlZCBub3RcbiAgICogdG8gY2hhbmdlIGluIGZ1dHVyZSByZWxlYXNlcyBvZiB0aGUgTW9tZW50byBub2RlLmpzIFNESy5cbiAgICogQHBhcmFtIHtNb21lbnRvTG9nZ2VyRmFjdG9yeX0gW2xvZ2dlckZhY3Rvcnk9ZGVmYXVsdExvZ2dlckZhY3RvcnldXG4gICAqIEByZXR1cm5zIHtDYWNoZUNvbmZpZ3VyYXRpb259XG4gICAqL1xuICBzdGF0aWMgdjEoXG4gICAgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3RvcnkgPSBkZWZhdWx0TG9nZ2VyRmFjdG9yeVxuICApOiBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAgIGNvbnN0IGRlYWRsaW5lTWlsbGlzID0gNTAwMDtcbiAgICBjb25zdCBncnBjQ29uZmlnOiBHcnBjQ29uZmlndXJhdGlvbiA9IG5ldyBTdGF0aWNHcnBjQ29uZmlndXJhdGlvbih7XG4gICAgICBkZWFkbGluZU1pbGxpczogZGVhZGxpbmVNaWxsaXMsXG4gICAgICBtYXhTZXNzaW9uTWVtb3J5TWI6IGRlZmF1bHRNYXhTZXNzaW9uTWVtb3J5TWIsXG4gICAgfSk7XG4gICAgY29uc3QgdHJhbnNwb3J0U3RyYXRlZ3k6IFRyYW5zcG9ydFN0cmF0ZWd5ID0gbmV3IFN0YXRpY1RyYW5zcG9ydFN0cmF0ZWd5KHtcbiAgICAgIGdycGNDb25maWd1cmF0aW9uOiBncnBjQ29uZmlnLFxuICAgICAgbWF4SWRsZU1pbGxpczogZGVmYXVsdE1heElkbGVNaWxsaXMsXG4gICAgfSk7XG4gICAgcmV0dXJuIG5ldyBMYXB0b3Aoe1xuICAgICAgbG9nZ2VyRmFjdG9yeTogbG9nZ2VyRmFjdG9yeSxcbiAgICAgIHJldHJ5U3RyYXRlZ3k6IGRlZmF1bHRSZXRyeVN0cmF0ZWd5KGxvZ2dlckZhY3RvcnkpLFxuICAgICAgdHJhbnNwb3J0U3RyYXRlZ3k6IHRyYW5zcG9ydFN0cmF0ZWd5LFxuICAgICAgbWlkZGxld2FyZXM6IGRlZmF1bHRNaWRkbGV3YXJlcyxcbiAgICB9KTtcbiAgfVxufVxuXG5jbGFzcyBJblJlZ2lvbkRlZmF1bHQgZXh0ZW5kcyBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAvKipcbiAgICogUHJvdmlkZXMgdGhlIGxhdGVzdCByZWNvbW1lbmRlZCBjb25maWd1cmF0aW9uIGZvciBhIHR5cGljYWwgaW4tcmVnaW9uIGVudmlyb25tZW50LiAgTk9URTogdGhpcyBjb25maWd1cmF0aW9uIG1heVxuICAgKiBjaGFuZ2UgaW4gZnV0dXJlIHJlbGVhc2VzIHRvIHRha2UgYWR2YW50YWdlIG9mIGltcHJvdmVtZW50cyB3ZSBpZGVudGlmeSBmb3IgZGVmYXVsdCBjb25maWd1cmF0aW9ucy5cbiAgICogQHBhcmFtIHtNb21lbnRvTG9nZ2VyRmFjdG9yeX0gW2xvZ2dlckZhY3Rvcnk9ZGVmYXVsdExvZ2dlckZhY3RvcnldXG4gICAqIEByZXR1cm5zIHtDYWNoZUNvbmZpZ3VyYXRpb259XG4gICAqL1xuICBzdGF0aWMgbGF0ZXN0KFxuICAgIGxvZ2dlckZhY3Rvcnk6IE1vbWVudG9Mb2dnZXJGYWN0b3J5ID0gZGVmYXVsdExvZ2dlckZhY3RvcnlcbiAgKTogQ2FjaGVDb25maWd1cmF0aW9uIHtcbiAgICByZXR1cm4gSW5SZWdpb25EZWZhdWx0LnYxKGxvZ2dlckZhY3RvcnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIHYxIHJlY29tbWVuZGVkIGNvbmZpZ3VyYXRpb24gZm9yIGEgdHlwaWNhbCBpbi1yZWdpb24gZW52aXJvbm1lbnQuICBUaGlzIGNvbmZpZ3VyYXRpb24gaXMgZ3VhcmFudGVlZCBub3RcbiAgICogdG8gY2hhbmdlIGluIGZ1dHVyZSByZWxlYXNlcyBvZiB0aGUgTW9tZW50byBub2RlLmpzIFNESy5cbiAgICogQHBhcmFtIHtNb21lbnRvTG9nZ2VyRmFjdG9yeX0gW2xvZ2dlckZhY3Rvcnk9ZGVmYXVsdExvZ2dlckZhY3RvcnldXG4gICAqIEByZXR1cm5zIHtDYWNoZUNvbmZpZ3VyYXRpb259XG4gICAqL1xuICBzdGF0aWMgdjEoXG4gICAgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3RvcnkgPSBkZWZhdWx0TG9nZ2VyRmFjdG9yeVxuICApOiBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAgIGNvbnN0IGRlYWRsaW5lTWlsbGlzID0gMTEwMDtcbiAgICBjb25zdCBncnBjQ29uZmlnOiBHcnBjQ29uZmlndXJhdGlvbiA9IG5ldyBTdGF0aWNHcnBjQ29uZmlndXJhdGlvbih7XG4gICAgICBkZWFkbGluZU1pbGxpczogZGVhZGxpbmVNaWxsaXMsXG4gICAgICBtYXhTZXNzaW9uTWVtb3J5TWI6IGRlZmF1bHRNYXhTZXNzaW9uTWVtb3J5TWIsXG4gICAgfSk7XG4gICAgY29uc3QgdHJhbnNwb3J0U3RyYXRlZ3k6IFRyYW5zcG9ydFN0cmF0ZWd5ID0gbmV3IFN0YXRpY1RyYW5zcG9ydFN0cmF0ZWd5KHtcbiAgICAgIGdycGNDb25maWd1cmF0aW9uOiBncnBjQ29uZmlnLFxuICAgICAgbWF4SWRsZU1pbGxpczogZGVmYXVsdE1heElkbGVNaWxsaXMsXG4gICAgfSk7XG4gICAgcmV0dXJuIG5ldyBJblJlZ2lvbkRlZmF1bHQoe1xuICAgICAgbG9nZ2VyRmFjdG9yeTogbG9nZ2VyRmFjdG9yeSxcbiAgICAgIHJldHJ5U3RyYXRlZ3k6IGRlZmF1bHRSZXRyeVN0cmF0ZWd5KGxvZ2dlckZhY3RvcnkpLFxuICAgICAgdHJhbnNwb3J0U3RyYXRlZ3k6IHRyYW5zcG9ydFN0cmF0ZWd5LFxuICAgICAgbWlkZGxld2FyZXM6IGRlZmF1bHRNaWRkbGV3YXJlcyxcbiAgICB9KTtcbiAgfVxufVxuXG5jbGFzcyBJblJlZ2lvbkxvd0xhdGVuY3kgZXh0ZW5kcyBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAvKipcbiAgICogUHJvdmlkZXMgdGhlIGxhdGVzdCByZWNvbW1lbmRlZCBjb25maWd1cmF0aW9uIGZvciBhbiBpbi1yZWdpb24gZW52aXJvbm1lbnQgd2l0aCBhZ2dyZXNzaXZlIGxvdy1sYXRlbmN5IHJlcXVpcmVtZW50cy5cbiAgICogTk9URTogdGhpcyBjb25maWd1cmF0aW9uIG1heSBjaGFuZ2UgaW4gZnV0dXJlIHJlbGVhc2VzIHRvIHRha2UgYWR2YW50YWdlIG9mIGltcHJvdmVtZW50cyB3ZSBpZGVudGlmeSBmb3IgZGVmYXVsdFxuICAgKiBjb25maWd1cmF0aW9ucy5cbiAgICogQHBhcmFtIHtNb21lbnRvTG9nZ2VyRmFjdG9yeX0gW2xvZ2dlckZhY3Rvcnk9ZGVmYXVsdExvZ2dlckZhY3RvcnldXG4gICAqIEByZXR1cm5zIHtDYWNoZUNvbmZpZ3VyYXRpb259XG4gICAqL1xuICBzdGF0aWMgbGF0ZXN0KFxuICAgIGxvZ2dlckZhY3Rvcnk6IE1vbWVudG9Mb2dnZXJGYWN0b3J5ID0gZGVmYXVsdExvZ2dlckZhY3RvcnlcbiAgKTogQ2FjaGVDb25maWd1cmF0aW9uIHtcbiAgICByZXR1cm4gSW5SZWdpb25Mb3dMYXRlbmN5LnYxKGxvZ2dlckZhY3RvcnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIHYxIHJlY29tbWVuZGVkIGNvbmZpZ3VyYXRpb24gZm9yIGFuIGluLXJlZ2lvbiBlbnZpcm9ubWVudCB3aXRoIGFnZ3Jlc3NpdmUgbG93LWxhdGVuY3kgcmVxdWlyZW1lbnRzLlxuICAgKiBUaGlzIGNvbmZpZ3VyYXRpb24gaXMgZ3VhcmFudGVlZCBub3QgdG8gY2hhbmdlIGluIGZ1dHVyZSByZWxlYXNlcyBvZiB0aGUgTW9tZW50byBub2RlLmpzIFNESy5cbiAgICogQHBhcmFtIHtNb21lbnRvTG9nZ2VyRmFjdG9yeX0gW2xvZ2dlckZhY3Rvcnk9ZGVmYXVsdExvZ2dlckZhY3RvcnldXG4gICAqIEByZXR1cm5zIHtDYWNoZUNvbmZpZ3VyYXRpb259XG4gICAqL1xuICBzdGF0aWMgdjEoXG4gICAgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3RvcnkgPSBkZWZhdWx0TG9nZ2VyRmFjdG9yeVxuICApOiBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAgIGNvbnN0IGRlYWRsaW5lTWlsbGlzID0gNTAwO1xuICAgIGNvbnN0IGdycGNDb25maWc6IEdycGNDb25maWd1cmF0aW9uID0gbmV3IFN0YXRpY0dycGNDb25maWd1cmF0aW9uKHtcbiAgICAgIGRlYWRsaW5lTWlsbGlzOiBkZWFkbGluZU1pbGxpcyxcbiAgICAgIG1heFNlc3Npb25NZW1vcnlNYjogZGVmYXVsdE1heFNlc3Npb25NZW1vcnlNYixcbiAgICB9KTtcbiAgICBjb25zdCB0cmFuc3BvcnRTdHJhdGVneTogVHJhbnNwb3J0U3RyYXRlZ3kgPSBuZXcgU3RhdGljVHJhbnNwb3J0U3RyYXRlZ3koe1xuICAgICAgZ3JwY0NvbmZpZ3VyYXRpb246IGdycGNDb25maWcsXG4gICAgICBtYXhJZGxlTWlsbGlzOiBkZWZhdWx0TWF4SWRsZU1pbGxpcyxcbiAgICB9KTtcbiAgICByZXR1cm4gbmV3IEluUmVnaW9uRGVmYXVsdCh7XG4gICAgICBsb2dnZXJGYWN0b3J5OiBsb2dnZXJGYWN0b3J5LFxuICAgICAgcmV0cnlTdHJhdGVneTogZGVmYXVsdFJldHJ5U3RyYXRlZ3kobG9nZ2VyRmFjdG9yeSksXG4gICAgICB0cmFuc3BvcnRTdHJhdGVneTogdHJhbnNwb3J0U3RyYXRlZ3ksXG4gICAgICBtaWRkbGV3YXJlczogZGVmYXVsdE1pZGRsZXdhcmVzLFxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogSW5SZWdpb24gcHJvdmlkZXMgZGVmYXVsdHMgc3VpdGFibGUgZm9yIGFuIGVudmlyb25tZW50IHdoZXJlIHlvdXIgY2xpZW50IGlzIHJ1bm5pbmcgaW4gdGhlIHNhbWUgcmVnaW9uIGFzIHRoZSBNb21lbnRvXG4gKiBzZXJ2aWNlLiAgSXQgaGFzIG1vcmUgYWdncmVzc2l2ZSB0aW1lb3V0cyBhbmQgcmV0cnkgYmVoYXZpb3IgdGhhbiB0aGUgTGFwdG9wIGNvbmZpZy5cbiAqIEBleHBvcnRcbiAqIEBjbGFzcyBJblJlZ2lvblxuICovXG5leHBvcnQgY2xhc3MgSW5SZWdpb24ge1xuICAvKipcbiAgICogVGhpcyBjb25maWcgcHJpb3JpdGl6ZXMgdGhyb3VnaHB1dCBhbmQgY2xpZW50IHJlc291cmNlIHV0aWxpemF0aW9uLiAgSXQgaGFzIGEgc2xpZ2h0bHkgcmVsYXhlZCBjbGllbnQtc2lkZSB0aW1lb3V0XG4gICAqIHNldHRpbmcgdG8gbWF4aW1pemUgdGhyb3VnaHB1dC5cbiAgICogQHR5cGUge0luUmVnaW9uRGVmYXVsdH1cbiAgICovXG4gIHN0YXRpYyBEZWZhdWx0ID0gSW5SZWdpb25EZWZhdWx0O1xuICAvKipcbiAgICogVGhpcyBjb25maWcgcHJpb3JpdGl6ZXMga2VlcGluZyBwOTkuOSBsYXRlbmNpZXMgYXMgbG93IGFzIHBvc3NpYmxlLCBwb3RlbnRpYWxseSBzYWNyaWZpY2luZ1xuICAgKiBzb21lIHRocm91Z2hwdXQgdG8gYWNoaWV2ZSB0aGlzLiAgSXQgaGFzIGEgdmVyeSBhZ2dyZXNzaXZlIGNsaWVudC1zaWRlIHRpbWVvdXQuICBVc2UgdGhpc1xuICAgKiBjb25maWd1cmF0aW9uIGlmIHRoZSBtb3N0IGltcG9ydGFudCBmYWN0b3IgaXMgdG8gZW5zdXJlIHRoYXQgY2FjaGUgdW5hdmFpbGFiaWxpdHkgZG9lc24ndCBmb3JjZVxuICAgKiB1bmFjY2VwdGFibHkgaGlnaCBsYXRlbmNpZXMgZm9yIHlvdXIgb3duIGFwcGxpY2F0aW9uLlxuICAgKiBAdHlwZSB7SW5SZWdpb25Mb3dMYXRlbmN5fVxuICAgKi9cbiAgc3RhdGljIExvd0xhdGVuY3kgPSBJblJlZ2lvbkxvd0xhdGVuY3k7XG59XG4iXX0=